/* DOIT rester tout en haut pour éviter le warning postcss-import */
@import '../styles/design-tokens.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===================== Base ===================== */
@layer base {
  html {
    /* lissage & comportement */
    scroll-behavior: smooth;
    text-rendering: optimizeLegibility;
    -webkit-text-size-adjust: 100%;
  }

  body {
    @apply min-h-dvh antialiased;
    background-color: hsl(var(--bg));
    color: hsl(var(--text));
    font-family: var(--font-sans);
    line-height: 1.6;
  }

  /* Titres : typographie fluide + balance */
  h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-heading);
    @apply tracking-tight font-semibold text-balance;
    color: hsl(var(--text));
  }
  h1 { font-size: var(--step-5); line-height: 1.05; }
  h2 { font-size: var(--step-4); line-height: 1.10; }
  h3 { font-size: var(--step-3); line-height: 1.15; }

  /* Texte courant */
  :is(p, li, dt, dd) { color: hsl(var(--text)); opacity: .88; }

  /* Médias responsives par défaut */
  :where(img, video) {
    display: block;
    max-width: 100%;
    height: auto;
  }
  :where(svg) { shape-rendering: geometricPrecision; text-rendering: optimizeLegibility; }

  /* Liens premium */
  a {
    color: hsl(var(--accent));
    text-underline-offset: 2px;
    transition: color var(--dur-fast) ease, opacity var(--dur-fast) ease, text-decoration-color var(--dur-fast) ease;
  }
  a:hover {
    color: hsl(var(--accent-600));
    text-decoration: underline;
    text-decoration-thickness: 2px;
  }
  a:focus-visible {
    outline: none;
    box-shadow:
      0 0 0 var(--ring-offset) hsl(var(--surface)),
      0 0 0 calc(var(--ring-offset) + 2px) hsl(var(--accent));
    border-radius: .5rem;
  }

  /* Formulaires – le plugin @tailwindcss/forms fait le gros du travail,
     on calibre juste les couleurs via tokens */
  input, textarea, select {
    color: hsl(var(--text));
    background-color: hsl(var(--surface));
    border-color: hsl(var(--border));
  }
  input::placeholder, textarea::placeholder { color: hsl(var(--text) / .5); }

  /* Scrollbars (plugin tailwind-scrollbar actif) */
  html {
    @apply scrollbar-thin scrollbar-track-transparent
           scrollbar-thumb-gray-300 dark:scrollbar-thumb-zinc-700;
  }

  /* Sélection de texte */
  ::selection {
    background: var(--selection-bg);
    color: var(--selection-fg);
  }
}

/* ================== Components ================== */
@layer components {
  /* Conteneur app cohérent avec container Tailwind */
  .container-app {
    @apply w-full mx-auto px-4 sm:px-6 lg:px-10;
    max-width: var(--container-max);
  }

  /* Cartes premium (cohérent avec .card/.card-pressable du plugin Tailwind) */
  .card {
    background: hsl(var(--surface));
    border: 1px solid hsl(var(--border));
    border-radius: var(--radius-2xl);
    box-shadow: var(--shadow-sm);
  }
  .card-hover {
    transition: box-shadow var(--dur) var(--ease-out), transform var(--dur) var(--ease-out);
  }
  .card-hover:hover { box-shadow: var(--shadow-md); }

  /* Boutons – variantes basiques */
  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-xl font-semibold px-4 py-2
           transition active:scale-[0.98] focus:outline-none;
  }
  .btn:focus-visible { @apply focus-ring; } /* utilitaire du plugin Tailwind */

  .btn-primary {
    @apply btn text-white;
    background: hsl(var(--accent));
  }
  .btn-primary:hover { background: hsl(var(--accent-600)); }

  .btn-ghost {
    @apply btn border bg-transparent;
    border-color: hsl(var(--border));
  }
  .btn-ghost:hover { background: hsl(var(--surface-2)); }

  .btn-outline {
    @apply btn border;
    color: hsl(var(--text));
    border-color: hsl(var(--border));
    background: transparent;
  }
  .btn-outline:hover { background: hsl(var(--surface-2)); }

  /* Badges / chips */
  .badge {
    @apply inline-flex items-center rounded-full px-2.5 py-0.5 text-[11px] font-medium;
    background: hsl(var(--surface-2));
    color: hsl(var(--text));
    border: 1px solid hsl(var(--border));
  }

  /* Text gradient utilitaire (pour titres “wow”) */
  .text-gradient {
    background: linear-gradient(90deg, hsl(var(--accent)), hsl(var(--accent-700)));
    -webkit-background-clip: text; background-clip: text;
    color: transparent;
  }
}

/* ================== Utilities =================== */
@layer utilities {
  .shadow-soft    { box-shadow: var(--shadow-sm); }
  .shadow-soft-lg { box-shadow: var(--shadow-lg); }

  /* Motion : on anime seulement quand autorisé */
  @media (prefers-reduced-motion: no-preference) {
    .motion-section {
      animation: fadeUp 0.45s var(--ease-out) both;
      will-change: transform, opacity;
    }
  }

  /* Accessibilité */
  .sr-only { @apply visually-hidden; } /* alias pratique */
}

/* =============== Keyframes locaux =============== */
@keyframes shimmer {
  0%   { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}
